# 匯入資料

_先將下載的文件更名為 `問卷數據.xlsx`，這不影響後續操作，只是對範例腳本名稱進行統一。_

<br>

## 啟動 SPSS

1. 可點擊 SPSS 應用圖標開啟，或使用終端機起動；不要點擊下載的文件來啟動。

    ```bash
    spss
    ```

<br>

## 步驟說明

1. `檔案 -> 新建 -> 語法`：開啟 SPSS，先新建一個空白語法文件。

    <img src="images/img_07.png" width="400px">

<br>

2. 開啟一個終端機，將 `問卷數據.xlsx` 文件從 Finder 拖曳到終端機中，並且記錄這個絕對路徑；使用 Windwos 也是相同概念，細節不贅述。

    ```bash
    /Users/samhsiao/Downloads/問卷數據.xlsx
    ```

    <img src="images/img_08.png" width="400px">

<br>

3. 使用語法匯入資料檔案，將絕對路徑複製貼上在 `/FILE=` 之後並以引號包覆；特別注意，SPSS Syntax 的註解是以 `星號 *` 開頭、`點 .` 結尾，之後不再贅述。

    ```bash
    *==============================.
    *請務必注意檔案路徑.
    GET DATA
      /TYPE=XLSX
      /FILE='/Users/samhsiao/Downloads/問卷數據.xlsx'
      /SHEET=name '表單回應 1'
      /CELLRANGE=FULL
      /READNAMES=ON
      /DATATYPEMIN PERCENTAGE=95.0
      /HIDDEN IGNORE=YES.
    EXECUTE.
    DATASET NAME 資料集1 WINDOW=FRONT.
    *==============================.
    ```

<br>

4. 語法執行的方式與資料庫語法的操作相同，先反白選取，然後點擊綠色的 `執行` 圖標 ▶️；運行之後主視窗會自動重啟；另外，若要使用組合鍵為 `command + R`。

    <img src="images/img_09.png" width="400px">

<br>

5. 重啟之後，切換進入 `變數視圖`。

    <img src="images/img_10.png" width="400px">

<br>

6. 可看到僅有 `時間戳記` 是 `數值`，其餘都是 `字串`；必須進行轉換，否則無法進行統計相關運算。

    <img src="images/img_11.png" width="400px">

<br>

7. 另外，較長的問題字串會被截斷。

    <img src="images/img_12.png" width="400px">

<br>

8. 可將無用的數據刪除，如 `時間戳記`、`抽獎` 等；這些在分析中沒有使用到的數據保留在原始的 Excel 檔案中即可；語法的運行同樣是反白選取之後執行，這部分之後不再贅述。

    ```bash
    *==============================.
    *刪除時間戳記等變數.
    DELETE VARIABLES 時間戳記.
    DELETE VARIABLES 如要參加抽獎請留下您的email，謝謝。.
    EXECUTE.
    *==============================.
    ```

<br>

9. 在本機電腦的桌面或文件中建立存放數據資料的資料夾；以下是終端機指令，可自行手動建立。

    ```bash
    mkdir /Users/samhsiao/Desktop/00_論文實作/
    ```

<br>

10. 進行第一次儲存；特別注意，這指令不會建立資料夾，務必確認資料夾已經存在。

    ```bash
    *==============================.
    *儲存檔案.
    SAVE OUTFILE='/Users/samhsiao/Desktop/00_論文實作/v01_01_匯入完成.sav'.
    *==============================.
    ```

<br>

11. 可進入 Finder 查看，確保第一次的文件操作正確進行。

    <img src="images/img_13.png" width="400px">

<br>

___

_END_
